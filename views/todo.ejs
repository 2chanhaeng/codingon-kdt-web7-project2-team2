<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../public/todo.css" />
</head>

<body>
    <div class="main">
        <h1>
            <p><span id="calYear"></span>년<span id="calMonth"></span>월<span id="calDay"></span>일 의 ToDo</p>
        </h1>
        <form class="" action="index.html" method="post">
            <input type="text" placeholder="새로운 할 일" name="todo" />
            <button type="submit"><b>추가</b></button>
        </form>
        <div class="todolist">
            <ul></ul>
            <a id="clear">모두 삭제</a>
        </div>
        <div class="todo-comment">오늘 todo에 comment달기</div>

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var calYear = localStorage.getItem("calYear");
            var calYearElement = document.getElementById("calYear");
            calYearElement.innerText = calYear;
        });
        document.addEventListener("DOMContentLoaded", function () {
            var calMonth = localStorage.getItem("calMonth");
            var calMonthElement = document.getElementById("calMonth");
            calMonthElement.innerText = calMonth;
        });
        document.addEventListener("DOMContentLoaded", function () {
            var calDay = localStorage.getItem("calDay");
            var calDayElement = document.getElementById("calDay");
            calDayElement.innerText = calDay;
        });

        init();

        function init() {
            document.querySelector('form').addEventListener('submit', addToDo);
            document.getElementById('clear').addEventListener('click', clearTodoList);
            document.querySelector('ul').addEventListener('click', deleteOrCheck);
        }

        function deleteOrCheck(e) {
            if (e.target.className == 'delete') deleteToDo(e); // X 버튼을 누르면 목록에서 항목 삭제
            else {
                checkToDo(e); // 체크박스를 클릭한 경우 글씨 색을 연하게 바꿔준다.
            }
        }

        function deleteToDo(e) {
            // X 버튼을 누르면 목록에서 항목 삭제
            let remove = e.target.parentNode;
            let parentNode = remove.parentNode;
            parentNode.removeChild(remove);
        }

        function checkToDo(e) {
            // 체크박스를 클릭한 경우 글씨 색을 연하게 바꿔준다.
            const todo = e.target.nextSibling;
            if (e.target.checked) {
                todo.style.color = '#dddddd';
            } else {
                todo.style.color = '#000000';
            }
        }

        function clearTodoList(e) {
            //목록 전체 삭제하는 경우
            let ul = (document.querySelector('ul').innerHTML = '');
        }

        function addToDo(e) {
            //새로운 할 일 추가하는 경우
            e.preventDefault();
            let toDoValue = document.querySelector('input');
            if (toDoValue.value !== '') addTask(toDoValue.value);
            toDoValue.value = ''; //입력창 비워주기
        }

        function addTask(value) {
            let ul = document.querySelector('ul');
            let li = document.createElement('li');
            li.innerHTML = `<span class="delete">x</span><input type="checkbox"><label>${value}</label>`;
            ul.appendChild(li);
            document.querySelector('.todolist').style.display = 'block';
        }
    </script>
</body>

</html>